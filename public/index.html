<!DOCTYPE html>
<html lang="pt-BR" data-theme="ocean">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="description" content="MedGemma CBM ‚Äî Plataforma interativa de IA m√©dica">
    <meta name="theme-color" content="#0a0a0a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>MedGemma CBM ‚Äî IA M√©dica Especialista</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <!-- Dynamic Mesh Gradient Background -->
    <div id="ambient-mesh">
        <div class="mesh-blob blob-1"></div>
        <div class="mesh-blob blob-2"></div>
        <div class="mesh-blob blob-3"></div>
        <div class="mesh-blob blob-4"></div>
    </div>

    <!-- Mobile Header (Glass) -->
    <header class="mobile-header">
        <button id="menu-toggle" class="menu-btn" aria-label="Menu">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
        </button>
        <div class="mobile-logo-text">üß¨ MedGemma</div>
    </header>

    <div class="app-layout">
        <!-- Floating Navigation Island -->
        <nav id="sidebar" class="nav-island">
            <div class="island-header">
                <div class="logo">
                    <div class="logo-glow">üß¨</div>
                    <div class="logo-text">
                        <span class="logo-title">MedGemma</span>
                        <span class="logo-sub">27B Inteligence</span>
                    </div>
                </div>
            </div>

            <div class="island-body">
                <button id="new-chat-btn" class="modern-btn primary shine-effect">
                    <span class="icon">‚ú®</span> Nova Conversa
                </button>

                <div class="island-section">
                    <span class="section-label">Portal Cl√≠nico</span>
                    <ul class="nav-list">
                        <li class="nav-item active" data-section="chat">
                            <span class="nav-icon">üí¨</span> Chat M√©dico
                        </li>
                        <li class="nav-item" data-section="history">
                            <span class="nav-icon">üìú</span> Hist√≥rico
                        </li>
                    </ul>
                </div>

                <div class="island-section">
                    <span class="section-label">Conversas Recentes</span>
                    <div id="conv-list" class="conv-list custom-scroll"></div>
                </div>

                <div class="island-section">
                    <span class="section-label">Sistema & Layout</span>
                    <ul class="nav-list">
                        <li class="nav-item" data-section="about">
                            <span class="nav-icon">üí°</span> Sobre a Plataforma
                        </li>
                        <li class="nav-item" data-section="settings">
                            <span class="nav-icon">‚öôÔ∏è</span> Configura√ß√µes
                        </li>
                    </ul>
                    <div class="theme-picker" id="theme-picker">
                        <button class="theme-dot" data-theme="gemini-dark" style="background:#0a0a0a"></button>
                        <button class="theme-dot active" data-theme="ocean" style="background:#0d1b2a"></button>
                        <button class="theme-dot" data-theme="emerald" style="background:#0a1a0f"></button>
                        <button class="theme-dot" data-theme="rose" style="background:#1a0a14"></button>
                        <button class="theme-dot" data-theme="amber" style="background:#1a1408"></button>
                        <button class="theme-dot" data-theme="lavender" style="background:#140f1a"></button>
                        <button class="theme-dot" data-theme="light" style="background:#f8f9fa"></button>
                    </div>
                </div>
            </div>

            <div class="island-footer">
                <div id="connection-status" class="status-pill disconnected">
                    <div class="pulse-ring"></div>
                    <span class="status-text">Offline</span>
                </div>
            </div>
        </nav>

        <!-- Main Workspace Area -->
        <main id="main-content" class="workspace">
            
            <!-- CHAT SECTION -->
            <section id="section-chat" class="section active">
                <div class="chat-wrapper">
                    <div id="chat-messages" class="chat-messages custom-scroll">
                        
                        <!-- Premium Welcome Hero / Bento Grid -->
                        <div class="welcome-hero">
                            <div class="hero-badge">Acesso Avan√ßado</div>
                            <h1 class="hero-title">
                                Ol√°. Eu sou o <span class="text-gradient">MedGemma</span>
                            </h1>
                            <p class="hero-subtitle">Intelig√™ncia cl√≠nica de n√≠vel especialista projetada com foco em cogni√ß√£o e precis√£o m√©dica.</p>
                            
                            <!-- Bento Grid for Quick Actions -->
                            <div class="bento-grid">
                                <div class="bento-card welcome-card" data-command="quiz">
                                    <div class="card-glow"></div>
                                    <div class="bento-icon">üß†</div>
                                    <div class="bento-content">
                                        <h3>Gerar Quiz</h3>
                                        <p>Treine seus conhecimentos cl√≠nicos.</p>
                                    </div>
                                </div>
                                <div class="bento-card welcome-card" data-command="caso">
                                    <div class="card-glow"></div>
                                    <div class="bento-icon">üìã</div>
                                    <div class="bento-content">
                                        <h3>Estudo de Caso</h3>
                                        <p>Simula√ß√µes avan√ßadas de pacientes.</p>
                                    </div>
                                </div>
                                <div class="bento-card welcome-card span-2" data-command="radiologia">
                                    <div class="card-glow"></div>
                                    <div class="card-bg-img medical-img"></div>
                                    <div class="bento-icon">ü©ª</div>
                                    <div class="bento-content">
                                        <h3>An√°lise Radiol√≥gica</h3>
                                        <p>Envie imagens de Raio-X, CT ou resson√¢ncia magn√©tica para extra√ß√£o de laudos estruturados com vis√£o computacional multimodal.</p>
                                    </div>
                                </div>
                                <div class="bento-card welcome-card" data-command="flashcard">
                                    <div class="card-glow"></div>
                                    <div class="bento-icon">üÉè</div>
                                    <div class="bento-content">
                                        <h3>Flashcards</h3>
                                        <p>Resumos memor√°veis r√°pidos.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- Floating Interaction Dock -->
                    <div class="interaction-dock-wrapper">
                        <!-- Image Preview Overlay -->
                        <div id="chat-image-preview" class="image-preview-glass hidden">
                            <div id="preview-thumbs" class="preview-thumbs custom-scroll"></div>
                            <button id="chat-clear-imgs" class="glass-btn icon-btn" title="Remover imagens">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M18 6L6 18M6 6l12 12" stroke-width="2" stroke-linecap="round"/></svg>
                            </button>
                        </div>

                        <!-- Main Input Pill -->
                        <div class="input-pill">
                            <label class="dock-btn" title="Anexar Imagens e PDFs">
                                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66l-9.2 9.19a2 2 0 01-2.83-2.83l8.49-8.48"/></svg>
                                <input type="file" id="chat-file-input" accept=".jpg,.jpeg,.png,.webp,.gif,.bmp,.tiff,.tif,.pdf" multiple hidden>
                            </label>
                            
                            <label class="dock-btn camera-btn" title="Usar a C√¢mera">
                                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"/><circle cx="12" cy="13" r="4"/></svg>
                                <input type="file" id="chat-camera-input" accept="image/*" capture="environment" hidden>
                            </label>

                            <textarea id="chat-input" placeholder="Converse com a intelig√™ncia m√©dica..." rows="1"></textarea>
                            
                            <button id="chat-send-btn" class="send-action-btn glass-btn" aria-label="Enviar">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- HISTORY SECTION -->
            <section id="section-history" class="section">
                <div class="content-container">
                    <header class="page-header">
                        <h2>Hist√≥rico Cl√≠nico</h2>
                        <p>Seus logs de intera√ß√£o com privacidade local absoluta. <span id="storage-count" class="badge">0</span></p>
                    </header>
                    <div id="history-list" class="glass-list">
                        <div class="empty-state">
                            <span class="empty-icon">üìÇ</span>
                            <p>Nenhum log gravado no reposit√≥rio seguro local.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ABOUT SECTION -->
            <section id="section-about" class="section">
                <div class="content-container">
                    <header class="page-header">
                        <h2>Sobre a Interface</h2>
                        <p>A arquitetura mental e digital por tr√°s do projeto.</p>
                    </header>
                    <div class="bento-grid about-grid">
                        <div class="bento-card span-2 highlight-card">
                            <div class="card-glow"></div>
                            <h3>üë®‚Äçüíª Engenharia de Interface</h3>
                            <p>Desenvolvido focado na <em>Psicologia do Design</em> para reduzir a carga cognitiva, promovendo uma navega√ß√£o espacial fluida.</p>
                            <p class="muted-text mt-2">Constru√≠do e idealizado por <strong>Ouderbi</strong> visando a democratiza√ß√£o da intelig√™ncia especializada, unindo requinte est√©tico ao MedGemma.</p>
                        </div>
                        <div class="bento-card">
                            <h3>üß¨ MedGemma (27B)</h3>
                            <p>Especialista multimodal focado em alta complexidade m√©dica, racioc√≠nio diagn√≥stico e vis√£o computacional radiol√≥gica baseada em Vertex AI.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SETTINGS SECTION -->
            <section id="section-settings" class="section">
                <div class="content-container">
                    <header class="page-header">
                        <h2>Workspace Config</h2>
                        <p>Gerenciamento de recursos do Vertex AI Pipeline.</p>
                    </header>
                    
                    <div class="settings-form-grid">
                        <div class="glass-card">
                            <div class="card-header">
                                <span class="card-icon">üîå</span>
                                <h3>Conex√£o Vertex AI</h3>
                            </div>
                            <div class="form-group modern-input">
                                <label for="set-api-base">API Base Proxy</label>
                                <input type="text" id="set-api-base" placeholder="https://proxy-url.run.app">
                            </div>
                            <div class="form-group modern-input">
                                <label for="set-endpoint">Vertex Endpoint ID</label>
                                <input type="text" id="set-endpoint" placeholder="https://us-central1-aiplatform...">
                            </div>
                            <div class="form-group modern-input">
                                <label for="set-apikey">GCP Bearer Token (Auth)</label>
                                <input type="password" id="set-apikey" placeholder="ya29.c.c0AY...">
                            </div>
                            <div class="action-row">
                                <button id="set-save-btn" class="modern-btn primary">Salvar Altera√ß√µes</button>
                                <button id="set-test-btn" class="modern-btn glass">Testar Conex√£o</button>
                            </div>
                            <div id="set-status" class="status-msg mt-3"></div>
                        </div>

                        <div class="glass-card">
                            <div class="card-header">
                                <span class="card-icon">üéõÔ∏è</span>
                                <h3>Par√¢metros de Infer√™ncia</h3>
                            </div>
                            <div class="slider-group">
                                <label for="set-temperature">Temperatura: <span id="temp-value" class="highlight-val">0.3</span></label>
                                <input type="range" id="set-temperature" class="modern-slider" min="0" max="1" step="0.05" value="0.3">
                            </div>
                            <div class="form-group modern-input mt-3">
                                <label for="set-maxtokens">Max Output Context (Tokens)</label>
                                <select id="set-maxtokens">
                                    <option value="512">512 Tokens</option>
                                    <option value="1024">1024 Tokens</option>
                                    <option value="2048" selected>2048 Tokens</option>
                                    <option value="4096">4096 Tokens</option>
                                    <option value="8192">8192 Tokens</option>
                                </select>
                            </div>
                            <div class="form-group modern-input mt-3">
                                <label for="set-system">System Instruction (Prompt)</label>
                                <textarea id="set-system" rows="3" class="custom-scroll">You are a helpful medical assistant. Sempre responda em portugu√™s do Brasil.</textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Scripts -->
    <script src="app.js"></script>
</body>
</html>
